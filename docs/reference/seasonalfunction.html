<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generic function for applying any R function to a zoo object, in order to obtain 4 representative seasonal values."><title>Seasonal Function — seasonalfunction • hydroTSM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Seasonal Function — seasonalfunction"><meta property="og:description" content="Generic function for applying any R function to a zoo object, in order to obtain 4 representative seasonal values."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hydroTSM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6-34</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hzambran/hydroTSM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Seasonal Function</h1>
      
      <div class="d-none name"><code>seasonalfunction.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generic function for applying any R function to a zoo object, in order to obtain 4 representative seasonal values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"default"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for zoo</span></span>
<span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"default"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"default"</span>,</span>
<span>                          dates<span class="op">=</span><span class="fl">1</span>, date.fmt <span class="op">=</span> <span class="st">"%Y-%m-%d"</span>, </span>
<span>                          out.type <span class="op">=</span> <span class="st">"data.frame"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span>                          </span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"default"</span>,</span>
<span>                          dates<span class="op">=</span><span class="fl">1</span>, date.fmt <span class="op">=</span> <span class="st">"%Y-%m-%d"</span>, </span>
<span>                          out.type <span class="op">=</span> <span class="st">"data.frame"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>zoo, data.frame or matrix object, with daily or monthly time series. <br>
Measurements at several gauging stations can be stored in a data.frame of matrix object, and in that case, each column of <code>x</code> represent the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).</p></dd>

  <dt>FUN</dt>
<dd><p>Function that will be applied to ALL the values in <code>x</code> belonging to each one of the 4 weather seasons (e.g., <code>FUN</code> can be some of <code>mean</code>, <code>max</code>, <code>min</code>, <code>sd</code>). <br></p></dd>

  <dt>na.rm</dt>
<dd><p>Logical. Should missing values be removed before the computations? <br>
-) <kbd>TRUE</kbd> : the monthly values  are computed considering only those values in <code>x</code> different from NA  (<b>very important when <code>FUN=sum</code></b>) <br>
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the FUN and monthly values are NA</p></dd>

  <dt>type</dt>
<dd><p>character, indicating which weather seasons will be used for computing the output. Possible values are: <br>
-) <kbd>default</kbd>          =&gt;  "winter"= Dec, Jan, Feb;      "spring"= Mar, Apr, May;  "summer"=Jun, Jul, Aug;       "autumn"= Sep, Oct, Nov  <br>
-) <kbd>FrenchPolynesia</kbd>  =&gt;  "winter"= Dec, Jan, Feb, Mar; "spring"= Apr, May;       "summer"=Jun, Jul, Aug, Sep;  "autumn"= Oct, Nov</p></dd>

  <dt>dates</dt>
<dd><p>numeric, factor, Date indicating how to obtain the dates. <br>
If <code>dates</code> is a number (default), it indicates the index of the column in <code>x</code> that stores the dates <br>
If <code>dates</code> is a factor, it is converted into Date class, by using the date format specified by <code>date.fmt</code>  <br>
If <code>dates</code> is already of Date class, the code verifies that the number of days in <code>dates</code> be equal to the number of element in <code>x</code></p></dd>

  <dt>date.fmt</dt>
<dd><p>Character indicating the format in which the dates are stored in <code>dates</code>, e.g. <kbd>%Y-%m-%d</kbd>. See <code>format</code> in <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></code>. <br>
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.</p></dd>

  <dt>out.type</dt>
<dd><p>Character defining the desired type of output. Valid values are: <br>
-) <kbd>data.frame</kbd>: a data.frame, with 4 columns representing the weather seasons, and as many rows as stations are included in <code>x</code> <br>
-) <kbd>db</kbd>        : a data.frame, with 4 colums will be produced. Useful for a posterior boxplot <br>
                 The first column (StationID) will store the ID of the station,  <br>
                 The second column (Year) will store the year,              <br>
                 The third column (Season) will store the season,  <br>
                 The fourth column (Value) will contain the seasonal value corresponding to that year and that station.</p></dd>

  <dt>verbose</dt>
<dd><p>Logical; if TRUE, progress messages are printed</p></dd>

  <dt>...</dt>
<dd><p>further arguments passed to or from other methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>FUN</code> is applied to all the values of <code>x</code> belonging to each one of the four weather seasons, so the results of this function depends on the frequency sampling of <code>x</code> and the type of function given by <code>FUN</code> <br></p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>The <var>FUN</var> value for the winter season (DJF) is computed considering the consecutive months of December, January and February. Therefore, if <code>x</code> starts in January and ends in December of any year, the winter value of the first year is computed considering only the January and February value of that year, whereas the December value of the first year is used to compute the winter value of the next year.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="dm2seasonal.html">dm2seasonal</a></code>, <code><a href="time2season.html">time2season</a></code>, <code><a href="monthlyfunction.html">monthlyfunction</a></code>, <code><a href="annualfunction.html">annualfunction</a></code>, <code><a href="extract.html">extract</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">## Loading the SanMartino precipitation data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SanMartinoPPts</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">SanMartinoPPts</span></span>
<span></span>
<span><span class="co"># Amount of years</span></span>
<span><span class="va">nyears</span> <span class="op">&lt;-</span> <span class="fu"><a href="yip.html">yip</a></span><span class="op">(</span>from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, out.type<span class="op">=</span><span class="st">"nmbr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Mean annual precipitation.</span></span>
<span><span class="co"># It is necessary to divide by the amount of years to obtain the mean annual value, </span></span>
<span><span class="co"># otherwise it will give the total precipitation for all the 70 years</span></span>
<span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">x</span>, FUN<span class="op">=</span><span class="va">sum</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="va">nyears</span></span>
<span></span>
<span><span class="co">#####################</span></span>
<span><span class="co">### verification ####</span></span>
<span><span class="co"># Mean winter (DJF) value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="extract.html">extractzoo</a></span><span class="op">(</span><span class="va">x</span>, trgt<span class="op">=</span><span class="st">"DJF"</span><span class="op">)</span> <span class="op">)</span> <span class="op">/</span> <span class="va">nyears</span></span>
<span></span>
<span><span class="co"># Mean spring (MAM) value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="extract.html">extractzoo</a></span><span class="op">(</span><span class="va">x</span>, trgt<span class="op">=</span><span class="st">"MAM"</span><span class="op">)</span> <span class="op">)</span> <span class="op">/</span> <span class="va">nyears</span></span>
<span></span>
<span><span class="co"># Mean summer (JJA) value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="extract.html">extractzoo</a></span><span class="op">(</span><span class="va">x</span>, trgt<span class="op">=</span><span class="st">"JJA"</span><span class="op">)</span> <span class="op">)</span> <span class="op">/</span> <span class="va">nyears</span></span>
<span></span>
<span><span class="co"># Mean autumn (SON) value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="extract.html">extractzoo</a></span><span class="op">(</span><span class="va">x</span>, trgt<span class="op">=</span><span class="st">"SON"</span><span class="op">)</span> <span class="op">)</span> <span class="op">/</span> <span class="va">nyears</span></span>
<span></span>
<span><span class="co"># \dontshow{</span></span>
<span><span class="co">############</span></span>
<span><span class="co">############</span></span>
<span><span class="co">## Loading the monthly time series of precipitation within the Ebro River basin.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">EbroPPtsMonthly</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">EbroPPtsMonthly</span></span>
<span></span>
<span><span class="co">## Winter (DJF) mean values of precipitation for the first 3 stations </span></span>
<span><span class="co">## in 'EbroPPtsMonthly' (its first column stores the dates)</span></span>
<span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, FUN<span class="op">=</span><span class="va">mean</span>, dates<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The same previous example, but using a zoo object</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># dates of the zoo object</span></span>
<span><span class="va">z</span>     <span class="op">&lt;-</span> <span class="fu">zoo</span><span class="op">(</span><span class="va">x</span><span class="op">[</span> ,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span>, <span class="va">dates</span><span class="op">)</span> <span class="co"># zoo creation</span></span>
<span><span class="fu">seasonalfunction</span><span class="op">(</span><span class="va">z</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="co"># }</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mauricio Zambrano-Bigiarini.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

