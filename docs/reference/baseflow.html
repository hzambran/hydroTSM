<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a complete (without missing values) series of streamflow, this function computes the baseflow using the filter proposed by Arnold and Allen (1999)."><title>Baseflow — baseflow • hydroTSM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Baseflow — baseflow"><meta property="og:description" content="Given a complete (without missing values) series of streamflow, this function computes the baseflow using the filter proposed by Arnold and Allen (1999)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hydroTSM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6-33</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hzambran/hydroTSM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Baseflow</h1>
      
      <div class="d-none name"><code>baseflow.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a complete (without missing values) series of streamflow, this function computes the baseflow using the filter proposed by Arnold and Allen (1999).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">baseflow</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for zoo</span></span>
<span><span class="fu">baseflow</span><span class="op">(</span><span class="va">x</span>, beta<span class="op">=</span><span class="fl">0.925</span>, from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">date.fmt</span>, <span class="va">tz</span>, </span>
<span>         na.fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"linear"</span>, <span class="st">"spline"</span><span class="op">)</span>, out.type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"last"</span>, <span class="st">"all"</span><span class="op">)</span>, </span>
<span>         plot<span class="op">=</span><span class="cn">FALSE</span>, xcol<span class="op">=</span><span class="st">"black"</span>, bfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"darkcyan"</span>, <span class="st">"darkorange3"</span><span class="op">)</span>,</span>
<span>         pch<span class="op">=</span><span class="fl">15</span>, cex<span class="op">=</span><span class="fl">0.3</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>zoo or numeric object with streamflow records. The suggested time frequency should be hourly or daily, but the algorithm will work with any time frequency.</p></dd>

  <dt>beta</dt>
<dd><p>numeric representing the filter parameter. Default value is 0.925 as recommended by Arnold and Allen (1999)</p></dd>

  <dt>from</dt>
<dd><p>Character indicating the starting date for creating the regularly spaced zoo object. The default value corresponds to the date of the first element of <code>x</code> <br>
It has to be in the format indicated by <code>date.fmt</code>.</p></dd>

  <dt>to</dt>
<dd><p>Character indicating the ending date for creating the regularly spaced zoo object. The default value corresponds to the date of the last element of <code>x</code> <br>
It has to be in the format indicated by <code>date.fmt</code>.</p></dd>

  <dt>date.fmt</dt>
<dd><p>character indicating the format in which the dates are stored in <code>from</code> and <code>to</code>, e.g. <kbd>%Y-%m-%d</kbd>. See ‘Details’ section in <code><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strptime</a></code>.
By default, <code>date.fmt</code> is missing, and it is automatically set to <kbd>%Y-%m-%d</kbd> when <code>time(x)</code> is <code>Date</code> object, and set to <kbd>%Y-%m-%d %H:%M:%S</kbd> when <code>x</code> is a sub-daily zoo object.</p></dd>

  <dt>tz</dt>
<dd><p>character, with the specification of the time zone used for <code>from</code>, <code>to</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">Sys.timezone</a></code> and <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>. <br></p>
<p>If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br></p>
<p>This argument can be used when working with sub-daily zoo objects to force using  time zones other than the local time zone for <code>from</code> and <code>to</code>. It should be used with caution, being well aware of the time zone of the data. See examples.</p></dd>

  <dt>na.fill</dt>
<dd><p>Character indicating how to fill any NA present in <code>x</code>. Valid values are: <br>
-) <kbd>remove</kbd>      =&gt; NAs are not plotted                                                         <br>
-) <kbd>linear</kbd>      =&gt; NAs are removed by linear interpolation, using <code><a href="https://rdrr.io/pkg/zoo/man/na.approx.html" class="external-link">na.approx</a></code> <br> 
-) <kbd>spline</kbd>      =&gt; NAs are removed by spline interpolation, using <code><a href="https://rdrr.io/pkg/zoo/man/na.approx.html" class="external-link">na.spline</a></code></p></dd>

  <dt>out.type</dt>
<dd><p>Character indicating the type of result that is given by this function. Valid values are: <br>
-) <kbd>last</kbd> =&gt; only the baseflow computed after the third pass of the filter is returned. <br>
-) <kbd>all</kbd>  =&gt; the 3 baseflows computed after each pass of the filter are returned in a matrix or zoo object.</p></dd>

  <dt>plot</dt>
<dd><p>logical. Indicates if the baseflow should be plotted or not. If plotted, the original <code>x</code> values are plotted as well.</p></dd>

  <dt>xcol</dt>
<dd><p>character, representing the color to be used for ploting the streamflow time series. Only used when <code>plot=TRUE</code>.</p></dd>

  <dt>bfcol</dt>
<dd><p>character of lenght 3, representing the color(s) to be used for ploting the baseflow time series. The first, second and third element are used to represent the baseflow after the third, second and first pass of the filter, respectively. Only used when <code>plot=TRUE</code>.</p></dd>

  <dt>pch</dt>
<dd><p>numeric, representing the symbols used for ploting the streamflow time series (both, the original series and the baseflow). Only used when <code>plot=TRUE</code>.</p></dd>

  <dt>cex</dt>
<dd><p>a numerical vector giving the amount by which plotting characters and symbols should be scaled relative to the default. This works as a multiple of <code>par("cex")</code>. See <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></code>. Only used when <code>plot=TRUE</code>.</p></dd>

  <dt>...</dt>
<dd><p>further arguments passed to or from other methods. Not used yet.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Although most procedures to separate baseflow from total streamflow are based on physical reasoning, some elements of all separation techniques are subjective.</p>
<p>The digital filter technique (Nathan and McMahon, 1990) implemented in this function was originally proposed by Lyne and Hollick (1979) for signal analysis and processing. Although this technique has no true physical meaning, it is objective and reproducible.</p>
<p>The equation of the filter is:</p>
<p>q(t) = Beta*q(t-1) + [ (1+Beta)/2 ]*[ Q(t) - Q(t-1) ]</p>
<p>where q(t) is the filtered surface runoff (quick response) at the time step t (one day), Q is the original streamflow, and Beta is the filter parameter (Beta=0.925). The value Beta=0.925 was obtained by Nathan and McMahon (1990) and Arnold et al. (1995) to give realistic results when compared to manual separation techniques.</p>
<p>Baseflow b(t) is then computed as:</p>
<p>b(t) = Q(t) - q(t)</p>
<p>The filter can be passed over the streamflow data three times (forward, backward, and forward), depending on the user' selected estimates of baseflow from pilot studies. In general, each pass will result in less baseflow as a percentage of total streamflow.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><!-- %%  If it is a LIST, use --></p>
<dl><dt>If <code>out.type="last"</code></dt>
<dd><p>(default value), only the baseflow computed after the third pass of the filter is returned.</p></dd>

  <dt>If <code>out.type="all"</code></dt>
<dd><p>the 3 baseflows computed after each pass of the filter are returned in a matrix or zoo object.</p></dd>

</dl><p><!-- %% ... --></p>


    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><cite>Arnold, J. G., Allen, P. M., Muttiah, R., Bernhardt, G. (1995). Automated base flow separation and recession analysis techniques. Groundwater, 33(6), 1010--1018. doi:10.1111/j.1745-6584.1995.tb00046.x</cite>.</p>
<p><cite>Arnold, J. G., Allen, P. M. (1999). Automated methods for estimating baseflow and ground water recharge from streamflow records. JAWRA Journal of the American Water Resources Association, 35(2), 411--424. doi:10.1111/j.1752-1688.1999.tb03599.x</cite>.</p>
<p><cite>Lyne, V., Hollick, M. (1979). Stochastic time-variable rainfall-runoff modelling. Proceedings of the Hydrology and Water Resources Symposium, Perth, 10--12 September. Institution of Engineers National Conference Publication, No. 79/10, 89--92</cite>.</p>
<p><cite>Nathan, R. J., &amp; McMahon, T. A. (1990). Evaluation of automated techniques for base flow and recession analyses. Water resources research, 26(7), 1465--1473. doi:10.1029/WR026i007p01465</cite>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_pq.html">plot_pq</a></code>, <code><a href="hydroplot.html">hydroplot</a></code>, <code><a href="fdc.html">fdc</a></code>, <code><a href="fdcu.html">fdcu</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">######################</span></span>
<span><span class="co">## Ex1: Computing and plotting the baseflows for the full time period</span></span>
<span><span class="co">##      of a given time series of streamflows.</span></span>
<span></span>
<span><span class="co">## First, we load the daily Q time series for the Cauquenes en </span></span>
<span><span class="co">## El Arrayan catchment, where Q, [m3/s] are stored in the sixth column.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Cauquenes7336001</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">Cauquenes7336001</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Computing the daily baseflow for the full time period</span></span>
<span><span class="co">#baseflow(q) # it can not run due to NA values in 'x'</span></span>
<span></span>
<span><span class="co"># filling the NA values using spline interpolation</span></span>
<span><span class="fu">baseflow</span><span class="op">(</span><span class="va">q</span>, na.fill<span class="op">=</span><span class="st">"spline"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## Computing and plotting the daily baseflow for the full time period</span></span>
<span><span class="fu">baseflow</span><span class="op">(</span><span class="va">q</span>, na.fill<span class="op">=</span><span class="st">"spline"</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">######################</span></span>
<span><span class="co">## Ex2: Computing and plotting the daily baseflow only for a </span></span>
<span><span class="co">##      specific time period, from April to December 2000.</span></span>
<span><span class="fu">baseflow</span><span class="op">(</span><span class="va">q</span>, na.fill<span class="op">=</span><span class="st">"spline"</span>, from<span class="op">=</span><span class="st">"2000-04-01"</span>, to<span class="op">=</span><span class="st">"2000-12-31"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">######################</span></span>
<span><span class="co">## Ex3: Computing and plotting the three daily baseflows (one for each pass </span></span>
<span><span class="co">##      of the filter) only for a specific time period, from April to December</span></span>
<span><span class="co">##      2000.</span></span>
<span><span class="fu">baseflow</span><span class="op">(</span><span class="va">q</span>, na.fill<span class="op">=</span><span class="st">"spline"</span>, from<span class="op">=</span><span class="st">"2000-04-01"</span>, to<span class="op">=</span><span class="st">"2000-12-31"</span>, </span>
<span>         out.type<span class="op">=</span><span class="st">"all"</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mauricio Zambrano-Bigiarini.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

