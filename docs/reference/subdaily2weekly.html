<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generic function for transforming a DAILY (or sub-daily) regular time series into a WEEKLY one"><title>Subdaily -&gt; Weekly — subdaily2weekly • hydroTSM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Subdaily -&gt; Weekly — subdaily2weekly"><meta property="og:description" content="Generic function for transforming a DAILY (or sub-daily) regular time series into a WEEKLY one"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hydroTSM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6-37</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hzambran/hydroTSM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Subdaily -&gt; Weekly</h1>
      
      <div class="d-none name"><code>subdaily2weekly.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generic function for transforming a DAILY (or sub-daily) regular time series into a WEEKLY one</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span>, na.rm.max<span class="op">=</span><span class="fl">0</span>,</span>
<span>           start<span class="op">=</span><span class="st">"00:00:00"</span>, start.fmt<span class="op">=</span> <span class="st">"%H:%M:%S"</span>, <span class="va">tz</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for zoo</span></span>
<span><span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span>, na.rm.max<span class="op">=</span><span class="fl">0</span>,</span>
<span>           start<span class="op">=</span><span class="st">"00:00:00"</span>, start.fmt<span class="op">=</span> <span class="st">"%H:%M:%S"</span>, <span class="va">tz</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span>, na.rm.max<span class="op">=</span><span class="fl">0</span>,</span>
<span>           start<span class="op">=</span><span class="st">"00:00:00"</span>, start.fmt<span class="op">=</span> <span class="st">"%H:%M:%S"</span>, <span class="va">tz</span>,</span>
<span>           dates<span class="op">=</span><span class="fl">1</span>, date.fmt <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>,  </span>
<span>           out.fmt<span class="op">=</span><span class="st">"zoo"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, <span class="va">FUN</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span>, na.rm.max<span class="op">=</span><span class="fl">0</span>,</span>
<span>           start<span class="op">=</span><span class="st">"00:00:00"</span>, start.fmt<span class="op">=</span> <span class="st">"%H:%M:%S"</span>, <span class="va">tz</span>,</span>
<span>           dates<span class="op">=</span><span class="fl">1</span>, date.fmt <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>,  </span>
<span>           out.fmt<span class="op">=</span><span class="st">"zoo"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>zoo, data.frame or matrix object, with (sub)daily time series. <br>
Measurements at several gauging stations can be stored in a data.frame or matrix object, and in that case, each column of <code>x</code> represents the time series measured in each gauging station, and the column names of <code>x</code> have to correspond to the ID of each station (starting by a letter).</p></dd>

  <dt>FUN</dt>
<dd><p>Function that have to be applied for transforming from daily to weekly time step (e.g., for precipitation <code>FUN=sum</code> and for temperature and streamflow ts <code>FUN=mean</code>). <br></p>
<p><code>FUN</code> MUST accept the <code>na.rm</code> argument, because <code>na.rm</code> is passed to <code>FUN</code>.</p></dd>

  <dt>na.rm</dt>
<dd><p>Logical. Should missing values be removed? <br>
-) <kbd>TRUE</kbd> : the weekly values are computed only for weeks with a percentage of missing values less than <code>na.rm.max</code> <br>
-) <kbd>FALSE</kbd>: if there is AT LEAST one NA within a month, the corresponing weekly values in the output object will be <code>NA</code>.</p></dd>

  <dt>na.rm.max</dt>
<dd><p>Numeric in [0, 1]. It is used to define the maximum percentage of missing values allowed in each month to keep the weekly aggregated value in the output object of this function. In other words, if the percentage of missing values in a given month is larger or equal than <code>na.rm.max</code> the corresponding weekly value will be <code>NA</code>.</p></dd>

  <dt>start</dt>
<dd><p>character, indicating the starting time used for aggregating sub-daily time series into daily ones. It MUST be provided in the format specified by <code>start.fmt</code>. <br>
This value is used to define the time when a new day begins (e.g., for some rain gauge stations). <br>
-) All the values of <code>x</code> with a time attribute before <code>start</code> are considered as belonging to the day before the one indicated in the time attribute of those values. <br>
-) All the values of <code>x</code> with a time attribute equal to <code>start</code> are considered to be equal to <code>"00:00:00"</code> in the output zoo object. <br>
-) All the values of <code>x</code> with a time attribute after <code>start</code> are considered as belonging to the same day as the one indicated in the time attribute of those values. <br></p>
<p>It is useful when the daily values start at a time different from <code>"00:00:00"</code>. Use with caution. See examples.</p></dd>

  <dt>start.fmt</dt>
<dd><p>character indicating the format in which the time is provided in <code>start</code>, By default <code>date.fmt=%H:%M:%S</code>. See <code>format</code> in <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>.</p></dd>

  <dt>tz</dt>
<dd><p>character, with the specification of the time zone used in both <code>x</code> and <code>start</code>. System-specific (see time zones), but <code>""</code> is the current time zone, and <code>"GMT"</code> is UTC (Universal Time, Coordinated). See <code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">Sys.timezone</a></code> and <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>. <br>
If <code>tz</code> is missing (the default), it is automatically set to the time zone used in <code>time(x)</code>. <br>
This argument can be used to force using the local time zone or any other time zone instead of UTC as time zone.</p></dd>

  <dt>dates</dt>
<dd><p>numeric, factor or Date object indicating how to obtain the dates for each gauging station <br>
If <code>dates</code> is a number (default), it indicates the index of the column in <var>x</var> that stores the dates <br>
If <code>dates</code> is a factor, it is converted into Date class, using the date format specified by <code>date.fmt</code>  <br>
If <code>dates</code> is already of Date class, the code verifies that the number of days on it be equal to the number of elements in <code>x</code></p></dd>

  <dt>date.fmt</dt>
<dd><p>character indicating the format in which the DateTime objects are stored in <var>dates</var>, e.g. <kbd>%Y-%m-%d %H:%M:%S</kbd>. See <code>format</code> in <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>. <br>
ONLY required when <code>class(dates)=="factor"</code> or <code>class(dates)=="numeric"</code>.</p></dd>

  <dt>out.fmt</dt>
<dd><p>OPTIONAL. Only used when <code>x</code> is a matrix or data.frame object /cr
character, for selecting if the result will be a matrix/data.frame or a zoo object. Valid values are: <kbd>numeric</kbd>, <kbd>zoo</kbd>.</p></dd>

  <dt>verbose</dt>
<dd><p>logical; if TRUE, progress messages are printed</p></dd>

  <dt>...</dt>
<dd><p>arguments additional to <code>na.rm</code> passed to <code>FUN</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a zoo object with weekly time frequency</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mauricio Zambrano-Bigiarini, <a href="mailto:mzb.devel@gmail">mzb.devel@gmail</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cmv.html">cmv</a></code>, <code><a href="subhourly2hourly.html">subhourly2hourly</a></code>, <code><a href="daily2monthly.html">daily2monthly</a></code>, <code><a href="daily2annual.html">daily2annual</a></code>, <code><a href="subdaily2daily.html">subdaily2daily</a></code>, <code><a href="weeklyfunction.html">weeklyfunction</a></code>, <code><a href="hydroplot.html">hydroplot</a></code>, <code><a href="vector2zoo.html">vector2zoo</a></code>, <code><a href="izoo2rzoo.html">izoo2rzoo</a></code>, <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">######################</span></span>
<span><span class="co">## Ex1: Computation of WEEKLY values from HOURLY ts, removing any missing value in 'x'</span></span>
<span></span>
<span><span class="co">## Loading the HOURLY streamflows for the station Karamea at Gorge</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">KarameaAtGorgeQts</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">KarameaAtGorgeQts</span></span>
<span></span>
<span><span class="co"># Sub-daily to weekly ts</span></span>
<span><span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, FUN<span class="op">=</span><span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">######################</span></span>
<span><span class="co">## Ex2: Computation of WEEKLY values from HOURLY ts, only when the percentage of NAs in </span></span>
<span><span class="co">#       each week is lower than a user-defined percentage (10</span></span>
<span></span>
<span><span class="co">## Loading the HOURLY streamflows for the station Karamea at Gorge</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">KarameaAtGorgeQts</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">KarameaAtGorgeQts</span></span>
<span></span>
<span><span class="co"># Subsetting 'x' to its first three weeks </span></span>
<span><span class="co"># (Monday 2nd December 1985 - Sunday 29th uanuary 20th 1980)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">x</span>, end<span class="op">=</span><span class="st">"1985-12-31 23:59:00"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Transforming into NA the 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co"># for reproducible results</span></span>
<span><span class="va">n</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">n.nas</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">*</span><span class="va">n</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">na.index</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">n.nas</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">na.index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co">## Daily to Weekly, only for weeks with less than 10</span></span>
<span><span class="op">(</span> <span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, FUN<span class="op">=</span><span class="va">sum</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span>, na.rm.max<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Verifying that the second and third month of 'x' had 10</span></span>
<span><span class="fu"><a href="cmv.html">cmv</a></span><span class="op">(</span><span class="va">x</span>, tscale<span class="op">=</span><span class="st">"weekly"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">######################</span></span>
<span><span class="co">## Ex3: Computation of WEEKLY values from HOURLY ts, removing any missing value in 'x'</span></span>
<span><span class="co">#       Loading the HOURLY streamflows for the station Karamea at Gorge</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">KarameaAtGorgeQts</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">KarameaAtGorgeQts</span></span>
<span></span>
<span><span class="co"># Sub-daily to weekly ts</span></span>
<span><span class="fu">subdaily2weekly</span><span class="op">(</span><span class="va">x</span>, FUN<span class="op">=</span><span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mauricio Zambrano-Bigiarini.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

